{% extends 'base.html.twig' %}

{% block title %}Nouvelle RequÃªte - MAESTRO{% endblock %}

{% block body %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card border-0 shadow-sm">
            <div class="card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h4 class="mb-0 text-white">
                    â• Nouvelle RequÃªte d'Analyse
                </h4>
                <small class="text-white-50">Projet: {{ project_name }}</small>
            </div>
            <div class="card-body">
                <p class="text-muted mb-4">
                    DÃ©crivez votre besoin ci-dessous. Les agents IA MAESTRO (PM, Cadrage, US, Dev, Test, Deploy)
                    vont analyser votre requÃªte et vous fournir une estimation complÃ¨te.
                </p>

                <form method="post">
                    <div class="mb-4">
                        <label for="title" class="form-label fw-bold">Titre de la requÃªte *</label>
                        <input type="text" class="form-control form-control-lg" id="title" name="title"
                               value="{{ title|default('') }}" required
                               placeholder="Ex: CrÃ©er une API REST pour la gestion des utilisateurs">
                        <small class="form-text text-muted">Un titre court et descriptif</small>
                    </div>

                    <div class="mb-4">
                        <label for="description" class="form-label fw-bold">Description dÃ©taillÃ©e *</label>
                        <textarea class="form-control" id="description" name="description" rows="8" required
                                  placeholder="DÃ©crivez en dÃ©tail votre besoin :&#10;- FonctionnalitÃ©s attendues&#10;- Contraintes techniques&#10;- Cas d'usage&#10;- Technologies prÃ©fÃ©rÃ©es&#10;- Etc.">{{ description|default('') }}</textarea>
                        <small class="form-text text-muted">Plus la description est dÃ©taillÃ©e, plus l'analyse sera prÃ©cise</small>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="type" class="form-label fw-bold">Type de requÃªte</label>
                            <select class="form-select" id="type" name="type">
                                <option value="FEATURE" {{ type|default('') == 'FEATURE' ? 'selected' : '' }}>âœ¨ Nouvelle fonctionnalitÃ©</option>
                                <option value="BUG" {{ type|default('') == 'BUG' ? 'selected' : '' }}>ğŸ› Correction de bug</option>
                                <option value="ENHANCEMENT" {{ type|default('') == 'ENHANCEMENT' ? 'selected' : '' }}>âš¡ AmÃ©lioration</option>
                                <option value="REFACTORING" {{ type|default('') == 'REFACTORING' ? 'selected' : '' }}>ğŸ”„ Refactoring</option>
                                <option value="DOCUMENTATION" {{ type|default('') == 'DOCUMENTATION' ? 'selected' : '' }}>ğŸ“š Documentation</option>
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label for="priority" class="form-label fw-bold">PrioritÃ©</label>
                            <select class="form-select" id="priority" name="priority">
                                <option value="LOW" {{ priority|default('') == 'LOW' ? 'selected' : '' }}>ğŸŸ¢ Basse</option>
                                <option value="MEDIUM" {{ priority|default('MEDIUM') == 'MEDIUM' ? 'selected' : '' }}>ğŸ”µ Moyenne</option>
                                <option value="HIGH" {{ priority|default('') == 'HIGH' ? 'selected' : '' }}>ğŸŸ¡ Haute</option>
                                <option value="CRITICAL" {{ priority|default('') == 'CRITICAL' ? 'selected' : '' }}>ğŸ”´ Critique</option>
                            </select>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>â„¹ï¸ Comment Ã§a marche ?</strong><br>
                        1. Votre requÃªte est envoyÃ©e au workflow n8n<br>
                        2. L'agent PM analyse et Ã©value la complexitÃ©<br>
                        3. L'agent Cadrage dÃ©finit l'architecture<br>
                        4. L'agent US gÃ©nÃ¨re les user stories<br>
                        5. Vous recevez une estimation complÃ¨te !
                    </div>

                    <div class="d-flex justify-content-between align-items-center">
                        <a href="{{ path('app_project_dashboard', {slug: app.session.get('current_project_slug')}) }}" class="btn btn-outline-secondary">
                            â† Annuler
                        </a>
                        <button type="submit" class="btn btn-primary btn-lg">
                            ğŸš€ Lancer l'Analyse
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
